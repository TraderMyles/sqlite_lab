{% extends "base.html" %}
{% block content %}
<h1>Expenses</h1>

<form action="{{ url_for('expenses_add') }}" method="post" class="grid form">
  <input type="date" name="date" value="{{ request.args.get('date','') }}">
  <input type="text" name="amount" placeholder="Amount (e.g., 12.99)" required>
  <input type="text" name="category" placeholder="Category" list="catlist" required>
  <input type="text" name="merchant" placeholder="Merchant">
  <input type="text" name="note" placeholder="Note">
  <button type="submit">Add</button>
</form>
<datalist id="catlist">
  {% for c in cats %}<option value="{{ c }}">{% endfor %}
</datalist>

<h2>Recent</h2>
<table>
  <thead><tr><th>Date</th><th>Merchant</th><th>Note</th><th>Category</th><th class="num">Amount</th></tr></thead>
  <tbody>
  {% for r in rows %}
    <tr>
      <td>{{ r.tx_date }}</td>
      <td>{{ r.merchant }}</td>
      <td>{{ r.note }}</td>
      <td>{{ r.category }}</td>
      <td class="num">£{{ '%.2f'|format(r.amount) }}</td>
    </tr>
  {% endfor %}
  </tbody>
</table>

<h2>By Month</h2>
<ul class="pill-list">
  {% for m in months %}
    <li><a href="{{ url_for('expenses_report', ym=m.ym) }}">{{ m.ym }} — £{{ '%.2f'|format(m.total) }}</a></li>
  {% endfor %}
</ul>
{% endblock %}
